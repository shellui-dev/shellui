@using BlazorInteractiveServer.Components.Models

<div class="@($"w-full {Class}")">
    <div class="inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground">
        @foreach (var tab in TabItems)
        {
            <button class="@($"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 {(ActiveTab == tab.Id ? "bg-background text-foreground shadow-sm" : "hover:bg-background/50")}")"
                    @onclick="() => SetActiveTab(tab.Id)">
                @if (!string.IsNullOrEmpty(tab.Icon))
                {
                    <span class="mr-2 h-4 w-4">@((MarkupString)tab.Icon)</span>
                }
                @tab.Label
                @if (tab.Badge != null)
                {
                    <span class="ml-2 rounded-full bg-primary px-2 py-0.5 text-xs text-primary-foreground">@tab.Badge</span>
                }
            </button>
        }
    </div>
    
    <div class="mt-2">
        @foreach (var tab in TabItems)
        {
            @if (ActiveTab == tab.Id)
            {
                <div class="space-y-2">
                    @tab.Content
                </div>
            }
        }
    </div>
</div>

@code {
    [Parameter] public List<TabItem> TabItems { get; set; } = new();
    [Parameter] public string? ActiveTab { get; set; }
    [Parameter] public EventCallback<string> ActiveTabChanged { get; set; }
    [Parameter] public string Class { get; set; } = string.Empty;

    private async Task SetActiveTab(string tabId)
    {
        ActiveTab = tabId;
        await ActiveTabChanged.InvokeAsync(tabId);
    }
}
